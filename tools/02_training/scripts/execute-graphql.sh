#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
# DO NOT MODIFY BELOW	
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	



if [[ ! $ROUTE =~ "ai-platform-api" ]]; then
      echo "       üõ†Ô∏è  Create Route"
      oc create route passthrough ai-platform-api -n $WAIOPS_NAMESPACE  --service=aimanager-aio-ai-platform-api-server --port=4000 --insecure-policy=Redirect --wildcard-policy=None
      export ROUTE=$(oc get route -n cp4waiops ai-platform-api  -o jsonpath={.spec.host})
      echo "        Route: $ROUTE"
      echo ""
fi

echo "     "	
echo "      üì• Launch Query for file: $FILE_NAME"	
echo "     "
QUERY="$(cat ../tools/02_training/training-definitions/$FILE_NAME)"
JSON_QUERY=$(echo "${QUERY}" | jq -sR '{"operationName": null, "variables": {}, "query": .}')
export result=$(curl -XPOST "https://$ROUTE/graphql" -s -k -H 'Content-Type: application/json' -d "${JSON_QUERY}")
echo "      üîé Result: "
echo "       "$result|jq ".data" | sed 's/^/          /'
echo "     "	
echo "     "	
